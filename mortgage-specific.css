/* ==========================================================================
   Mortgage Calculator Specific Styles
   Mortgage-specific colors, layouts, and component overrides
   Requires: cfa-base.css
   
   NOTE: All table styles are now in cfa-base.css for consistency
   ========================================================================== */

/* ==========================================================================
   1. STATIC EQUATIONS GRID - Two column layout
   ========================================================================== */
.static-equations-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1.5rem;
  margin-top: 1rem;
}

.static-equation-row {
  display: grid;
  grid-template-columns: minmax(0, 1.6fr) minmax(0, 1.2fr);
  align-items: center;
  column-gap: 1.75rem;
  row-gap: 0.75rem;
}

.static-equation-label {
  font-size: 0.9375rem;  /* 15px - matches dividend */
  font-weight: 600;
  line-height: 1.5;  /* 22.5px at 15px base */
  color: var(--color-gray-800);  /* rgb(31, 41, 55) */
  margin: 0;
  padding: 0;
}

.static-equation-math {
  text-align: left;
}

/* Stack on narrow screens */
@media (max-width: 700px) {
  .static-equation-row {
    grid-template-columns: 1fr;
  }
  
  .static-equation-math {
    text-align: center;
  }
}

/* ==========================================================================
   1.5 MORTGAGE-SPECIFIC COLOR ASSIGNMENTS
   ========================================================================== */
:root {
  /* Mortgage Calculator Specific Colors - Using brand palette */
  --color-mortgage-payment: var(--color-blue-interactive);  /* #3c6ae5 - Monthly payment (PMT) */
  --color-mortgage-principal: var(--color-red-2);           /* #b82937 - Principal (PRN) */
  --color-mortgage-interest: var(--color-teal-data);        /* #0079a6 - Interest (INT) */
  --color-mortgage-term: var(--color-green-data-alt);       /* #047857 - Loan term (t) */
  --color-mortgage-rate: var(--color-purple-bold);          /* #7a46ff - Interest rate (r) */
}

/* ==========================================================================
   TABLE EXPANDABLE ROWS
   ========================================================================== */
.year-row {
  cursor: default;
}

/* Section toggle button (for collapsible cards) */
.toggle-section-btn {
  background: none;
  border: none;
  color: var(--color-gray-600);
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  font-size: 1rem;
  display: inline-flex;
  align-items: center;
  transition: color 0.2s ease, transform 0.2s ease;
  min-width: 44px;
  min-height: 44px;
}

.toggle-section-btn:hover {
  color: var(--color-gray-800);
}

.toggle-section-btn:focus {
  outline: 2px solid var(--color-blue-interactive);
  outline-offset: 2px;
  border-radius: 4px;
}

.toggle-section-btn .toggle-icon {
  display: inline-block;
  transition: transform 0.2s ease;
}

.toggle-section-btn[aria-expanded="false"] .toggle-icon {
  transform: rotate(-90deg);
}

.expand-btn {
  background: none;
  border: none;
  color: var(--color-blue-interactive);
  cursor: pointer;
  padding: 0.25rem 0.35rem;
  margin-right: 0.25rem;
  font-size: 0.875rem;
  vertical-align: middle;
  display: inline-flex;
  align-items: center;
  transition: color 0.2s ease;
  line-height: 1;
}

.expand-btn:hover {
  color: var(--color-primary-dark-blue);
}

.expand-btn:focus {
  outline: 2px solid var(--color-blue-interactive);
  outline-offset: 2px;
  border-radius: 2px;
}

.expand-icon {
  display: inline-block;
  width: 0.875rem;
  text-align: center;
  font-size: 0.75rem;
}

.month-row {
  background-color: var(--color-gray-50);
  font-size: 0.875rem;
}

.month-row td {
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  border-top: 1px solid var(--color-gray-200);
}

.month-cell {
  padding-left: 2.5rem !important;
  color: var(--color-gray-600);
  font-style: italic;
  font-size: 0.8125rem;
}

/* Responsive - adjust for mobile */
@media (max-width: 768px) {
  .expand-btn {
    padding: 0.5rem;
  }
  
  .month-cell {
    padding-left: 1.5rem !important;
  }
}


/* ==========================================================================
   1.5 MODEL EQUATIONS GRID - Three Formula Boxes
   ========================================================================== */
.model-equations-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1rem;
}

@media (min-width: 768px) {
  .model-equations-grid {
    grid-template-columns: 1fr 1fr 1fr;  /* Equal thirds */
  }
}

@media (max-width: 767px) {
  .model-equations-grid {
    grid-template-columns: 1fr;
  }
  
  .formula-box {
    min-height: auto;
  }
}

/* ==========================================================================
   1.5 FORMULA BOXES - Override cfa-base.css completely
   ========================================================================== */
.formula-box {
  /* Remove ALL borders first */
  border: none !important;
  border-top: none !important;
  border-right: none !important;
  border-bottom: none !important;
  /* Only left border */
  border-left: 4px solid var(--color-gray-400) !important;
  /* Styling */
  padding: 0.75rem 1rem !important;
  background: white !important;
  border-radius: 0 0.5rem 0.5rem 0 !important;
  margin-top: 0 !important;
  min-height: 160px;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  overflow: hidden;
}

.formula-box:focus {
  outline: 3px solid var(--color-gray-400);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(107, 114, 128, 0.1);
}

.formula-box.pmt {
  border-left-color: #3c6ae5 !important;  /* Blue */
}

.formula-box.pmt:focus {
  outline-color: #3c6ae5;
  box-shadow: 0 0 0 4px rgba(60, 106, 229, 0.1);
}

.formula-box.int {
  border-left-color: #0079a6 !important;  /* Teal to match INT color */
}

.formula-box.int:focus {
  outline-color: #0079a6;
  box-shadow: 0 0 0 4px rgba(0, 121, 166, 0.1);
}

.formula-box.prn {
  border-left-color: #b82937 !important;  /* Red to match PRN color */
}

.formula-box.prn:focus {
  outline-color: #b82937;
  box-shadow: 0 0 0 4px rgba(184, 41, 55, 0.1);
}

.formula-box-title {
  font-size: 0.875rem !important;
  font-weight: 600 !important;
  color: var(--color-gray-700) !important;
  margin-top: 0 !important;
  margin-bottom: 0.5rem !important;
  text-align: center !important;
  text-transform: none !important;  /* Keep original case - no uppercase */
  letter-spacing: 0.025em !important;
  padding: 0 !important;
}

.equation-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  /* Override cfa-base.css box styling */
  border: none !important;
  background: transparent !important;
  box-shadow: none !important;
  padding: 0.5rem !important;
  margin: 0 !important;
}

/* Equation result styling */
.equation-result-main {
  font-size: 1.1rem;
  font-weight: 600;
  padding: 0.5rem 1rem;
  border-radius: 0.375rem;
  text-align: center;
}

.equation-result-main.pmt {
  color: #1e40af;  /* Darker blue for contrast */
  background: rgba(60, 106, 229, 0.08);
  font-weight: 700;  /* Bolder for better readability */
}

.equation-result-main.int {
  color: #005f7f;  /* Darker teal for contrast */
  background: rgba(0, 121, 166, 0.08);
  font-weight: 700;
}

.equation-result-main.prn {
  color: #8b1f2b;  /* Darker red for contrast */
  background: rgba(184, 41, 55, 0.08);
  font-weight: 700;
}

.equation-note {
  font-size: 0.8125rem;
  color: var(--color-gray-600);
  font-style: italic;
  text-align: center;
  margin-top: 0.5rem;
}

.equation-intro {
  font-size: 0.875rem;
  color: var(--color-gray-600);
  margin-bottom: 1rem;
  text-align: left;
}

/* ==========================================================================
   1.5 MIDDLE ROW LAYOUT - 1:3 RATIO
   ========================================================================== */
.middle-row {
  display: grid;
  grid-template-columns: 1fr 3fr;
  gap: 1.5rem;
}

/* Stack on mobile */
@media (max-width: 768px) {
  .middle-row {
    grid-template-columns: 1fr;
  }
}

/* ==========================================================================
/* ==========================================================================
   2. RESULT BOXES - Mortgage-Specific (3-box layout)
   ========================================================================== */

/* Table description */
.table-description {
  font-size: 0.875rem;
  color: var(--color-gray-700);
  margin-bottom: 1rem;
  line-height: 1.6;
}

.table-description strong {
  color: var(--color-gray-900);
  font-weight: 600;
}

/* Table header override for better contrast with colored abbreviations */
#data-table th {
  background: #f9fafb !important;  /* Lighter than gray-100 for WCAG compliance */
}

.results-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1rem;
}

/* Principal Amount Box - Orange theme */
.result-box-principal {
  background-color: #fff7ed;  /* Light Orange BG */
  border: 2px solid #b95b1d;  /* Orange Deep border */
  border-radius: 0.5rem;
  padding: 1.25rem;
}

.result-box-principal:focus {
  outline: 3px solid #b95b1d;
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(185, 91, 29, 0.1);
}

/* Result box titles - standardized typography with theme colors */
.result-box-principal .result-title {
  font-size: 0.8125rem;
  font-weight: 600;
  color: #8b4513;  /* Orange theme */
  margin-bottom: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.025em;
}

.result-box-monthly .result-title {
  font-size: 0.8125rem;
  font-weight: 600;
  color: #1e40af;  /* Blue theme */
  margin-bottom: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.025em;
}

.result-box-interest .result-title {
  font-size: 0.8125rem;
  font-weight: 600;
  color: #7a46ff;  /* Purple theme */
  margin-bottom: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.025em;
}

/* Result values - standardized BLACK with SANS-SERIF across all boxes */
.result-box-principal .result-value,
.result-box-monthly .result-value,
.result-box-interest .result-value {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-size: 1.5rem;
  font-weight: 800;
  color: var(--color-gray-900);  /* Black for all numbers */
  line-height: 1.2;
  margin-bottom: 0.5rem;
}

/* Monthly Payment Box - Blue theme */
.result-box-monthly {
  background-color: #eff6ff;  /* Light Blue BG */
  border: 2px solid #3c6ae5;  /* Blue Interactive border */
  border-radius: 0.5rem;
  padding: 1.25rem;
}

.result-box-monthly:focus {
  outline: 3px solid #3c6ae5;
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(60, 106, 229, 0.1);
}

.result-box-monthly .result-subtitle {
  font-size: 0.8125rem;
  font-weight: 500;
  color: var(--color-gray-600);
}

/* Interest Box - Purple theme */
.result-box-interest {
  background-color: #faf5ff;  /* Light Purple BG */
  border: 2px solid #7a46ff;  /* Purple Bold border */
  border-radius: 0.5rem;
  padding: 1.25rem;
}

.result-box-interest:focus {
  outline: 3px solid #7a46ff;
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(122, 70, 255, 0.1);
}

.result-box-interest .result-detail {
  font-size: 0.8125rem;
  font-weight: 500;
  color: var(--color-gray-700);
  margin-bottom: 0.25rem;
  line-height: 1.6;
}

.result-box-interest .result-detail strong {
  color: var(--color-gray-900);  /* Black for emphasis */
  font-weight: 600;
}

.result-box-interest .result-detail:last-child {
  margin-bottom: 0;
}

/* ==========================================================================
   3. INPUT LAYOUT - Bond-style Inline Layout
   ========================================================================== */
.input-group-inline {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 2rem;
}

.input-inline {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  white-space: nowrap;
}

.input-label-inline {
  font-size: 0.875rem;
  color: var(--color-gray-700);
  min-width: fit-content;
}

.input-with-suffix-inline {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  width: 6rem;
  position: relative;
}

/* Wider input for mortgage amount field to accommodate $10,000,000 */
.input-inline:first-child .input-with-suffix-inline {
  width: 9rem;
}

.input-prefix-inline {
  position: absolute;
  left: 0.4rem;
  top: 50%;
  transform: translateY(-50%);
  color: var(--color-gray-500);
  pointer-events: none;
  font-size: 0.875rem;
  z-index: 1;
}

.input-field-inline.input-with-prefix {
  padding-left: 2.5rem;
}

.input-field-inline {
  flex: 1;
  width: 100%;
  padding: 0.4rem 0.5rem;
  padding-right: 1.5rem;
  border: 1px solid var(--color-gray-300);
  border-radius: 0.375rem;
  font-size: 0.875rem;
  text-align: right;
  box-sizing: border-box;
}

.input-field-inline:hover {
  border-color: var(--color-gray-500);
}

.input-field-inline:focus {
  outline: none;
  border-color: var(--color-blue-interactive);
  box-shadow: 0 0 0 2px rgba(60, 106, 229, 0.1);
}

.input-suffix-inline {
  position: absolute;
  right: 0.4rem;
  top: 50%;
  transform: translateY(-50%);
  color: var(--color-gray-500);
  pointer-events: none;
  width: 1.2rem;
  text-align: right;
  font-size: 0.875rem;
}

@media (max-width: 640px) {
  .input-group-inline {
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
  }
  
  .input-inline {
    width: 100%;
  }
  
  .input-with-suffix-inline {
    width: 100%;
    max-width: 12rem;
  }
}

/* ==========================================================================
   4. EDUCATIONAL NOTE
   ========================================================================== */
.educational-note {
  margin-top: 1rem;
  padding: 0.75rem;
  background: var(--color-gray-50);
  border-radius: 0.5rem;
  font-size: 0.875rem;
  color: var(--color-gray-700);
}

/* ==========================================================================
   5. CHART LEGEND - Mortgage-specific
   ========================================================================== */
.chart-legend {
  display: flex;
  flex-wrap: wrap;
  gap: 1.5rem;
  margin-bottom: 1rem;
  font-size: 0.875rem;
  color: var(--color-gray-700);
}

.legend-item {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}

.legend-color {
  width: 0.75rem;
  height: 0.75rem;
  border-radius: 0.125rem;
  display: inline-block;
}

/* ==========================================================================
   6. DYNAMIC EQUATION CONTAINER
   ========================================================================== */
#dynamic-equation-container {
  margin-top: 0.5rem;
}

#dynamic-equation-container math {
  font-size: 1rem;
  color: var(--color-gray-700);
}

/* Center the generated equation the same way as the static one */
#dynamic-mathml-equation { 
  text-align: center; 
}
#dynamic-mathml-equation > math {
  display: inline-block;
  margin: 0.5em auto;
}


/* Match the bond page's robust centering */
.equation-container { text-align: center; }
#mathml-equation { display: inline-block; width: auto; }
math[display="block"] { margin: 0.5em auto; }

/* Force equation boxes to match dividend - nuclear option */
.model-equations-grid .formula-box,
.card .formula-box,
#equation-card .formula-box {
  border: 0 !important;
  border-width: 0 !important;
  border-style: none !important;
  border-left: 4px solid #999 !important;
  border-left-width: 4px !important;
  border-left-style: solid !important;
}

#equation-card .formula-box.pmt {
  border-left-color: #3c6ae5 !important;
}

#equation-card .formula-box.int {
  border-left-color: #0079a6 !important;  /* Teal */
}

#equation-card .formula-box.prn {
  border-left-color: #b82937 !important;  /* Red */
}

/* ==========================================================================
   DYNAMIC EQUATION - AGGRESSIVE MOBILE SCALING
   ========================================================================== */

/* More aggressive scaling for dynamic equations at narrow widths */
@media (max-width: 400px) {
  #dynamic-equation-container math,
  .formula-box math {
    font-size: 0.55em !important;
  }
  
  .equation-container {
    padding: 0.25rem !important;
    overflow-x: hidden !important;  /* Hide scrollbar, rely on scaling */
  }
}

@media (max-width: 340px) {
  #dynamic-equation-container math,
  .formula-box math {
    font-size: 0.5em !important;
  }
  
  .equation-container {
    padding: 0.125rem !important;
  }
}

/* Ensure formula boxes don't overflow */
.formula-box .equation-container {
  overflow-x: hidden !important;
  width: 100%;
}

.formula-box math {
  max-width: 100%;
  display: inline-block !important;
}